<app-section-page
  title="State Management â€” Signal Store vs Zustand"
  subtitle="Angular's Service + Signals pattern vs React's Zustand / Redux Toolkit for global state"
  icon="ðŸ—„ï¸"
>
  <!-- Live Store Demo -->
  <div class="demo-card">
    <h3 class="demo-title">ðŸŽ® Live TodoStore Demo</h3>
    <p class="demo-subtitle">
      A singleton Angular service with signals â€” same instance across all components
    </p>

    <!-- Progress -->
    <div style="margin-bottom: 1.25rem">
      <div
        style="
          display: flex;
          justify-content: space-between;
          font-size: 0.8rem;
          color: #64748b;
          margin-bottom: 0.375rem;
        "
      >
        <span>{{ store.completedCount() }} / {{ store.totalCount() }} completed</span>
        <span>{{ store.progress() }}%</span>
      </div>
      <div
        style="
          background: rgba(99, 102, 241, 0.15);
          border-radius: 999px;
          height: 6px;
          overflow: hidden;
        "
      >
        <div
          style="
            height: 100%;
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            border-radius: 999px;
            transition: width 0.3s;
          "
          [style.width]="store.progress() + '%'"
        ></div>
      </div>
    </div>

    <!-- Add todo -->
    <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem">
      <input
        [value]="newTodo()"
        (input)="updateInput($event)"
        (keydown)="onKeydown($event)"
        placeholder="Add a todo... (press Enter)"
        class="form-input-demo"
        style="flex: 1"
      />
      <button class="btn btn-primary" (click)="addTodo()">Add</button>
    </div>

    <!-- Todo list -->
    <div style="display: flex; flex-direction: column; gap: 0.4rem; margin-bottom: 1rem">
      @for (todo of store.todos(); track todo.id) {
        <div
          style="
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.75rem;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(99, 102, 241, 0.1);
            border-radius: 0.5rem;
          "
        >
          <input
            type="checkbox"
            [checked]="todo.done"
            (change)="store.toggleTodo(todo.id)"
            style="
              accent-color: #6366f1;
              cursor: pointer;
              width: 16px;
              height: 16px;
              flex-shrink: 0;
            "
          />
          <span
            style="flex: 1; font-size: 0.875rem"
            [style.textDecoration]="todo.done ? 'line-through' : 'none'"
            [style.color]="todo.done ? '#475569' : '#e2e8f0'"
          >
            {{ todo.text }}
          </span>
          <button
            (click)="store.removeTodo(todo.id)"
            style="
              background: none;
              border: none;
              cursor: pointer;
              color: #475569;
              font-size: 1rem;
              padding: 0;
              line-height: 1;
            "
          >
            Ã—
          </button>
        </div>
      } @empty {
        <p style="text-align: center; color: #475569; padding: 1rem; font-size: 0.85rem">
          No todos yet. Add one above!
        </p>
      }
    </div>

    <button class="btn btn-ghost" style="font-size: 0.78rem" (click)="store.clearCompleted()">
      Clear Completed ({{ store.completedCount() }})
    </button>
  </div>

  <!-- Concept -->
  <div class="concept-box">
    <h3 class="concept-title">ðŸ’¡ Angular Services as Global Stores</h3>
    <div class="concept-content">
      <p>
        In Angular, <strong>services with <code>providedIn: 'root'</code></strong> are singletons â€”
        instantiated once for the entire app. This is Angular's built-in alternative to Zustand or
        Redux context providers. No extra library needed!
      </p>
      <div class="concept-grid">
        <div class="concept-item">
          <span class="concept-icon">ðŸ“¦</span>
          <div>
            <strong>Service + Signals</strong> = Zustand equivalent (simple, no boilerplate)
          </div>
        </div>
        <div class="concept-item">
          <span class="concept-icon">âš¡</span>
          <div>
            <strong>NgRx Store</strong> = Redux Toolkit equivalent (complex apps, time-travel
            debugging)
          </div>
        </div>
        <div class="concept-item">
          <span class="concept-icon">ðŸ”—</span>
          <div><strong>inject()</strong> = useSomeStore() hook â€” gets the singleton anywhere</div>
        </div>
        <div class="concept-item">
          <span class="concept-icon">ðŸ§®</span>
          <div><strong>computed()</strong> = Zustand derived stores / Redux selectors</div>
        </div>
      </div>
    </div>
  </div>

  <div class="comparison-section">
    <h3 class="comparison-title">1. Global Store â€” Zustand vs Angular Services</h3>
    <app-comparison-card
      [reactCode]="zustandStore"
      [angularCode]="angularSignalStore"
      reactLabel="Zustand store"
      angularLabel="Angular Service + Signals"
    />
    <div class="key-diff-note">
      <strong>Key insight:</strong> Angular's <code>providedIn: 'root'</code> services are
      singletons automatically â€” no need to wrap your app in a Provider component. The DI system
      handles it. Just <code>inject(TodoStore)</code> anywhere and you get the same instance.
    </div>
  </div>

  <div class="comparison-section">
    <h3 class="comparison-title">2. NgRx â€” For Complex Apps (Redux-style)</h3>
    <app-code-block
      [code]="ngrxStore"
      language="angular-ts"
      label="NgRx Store â€” Actions, Reducers, Selectors"
    />
    <div class="key-diff-note">
      <strong>When to use NgRx?</strong> Use NgRx when you have complex state transitions, need
      time-travel debugging, or have a large team needing strict conventions â€” similar to how React
      teams use Redux Toolkit. For most Angular apps, Services + Signals is sufficient.
    </div>
  </div>
</app-section-page>
